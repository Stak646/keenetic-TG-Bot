# Keenetic TG Bot (Entware) ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–º, HydraRoute, NFQWS2, AWG

Telegram‚Äë–±–æ—Ç –¥–ª—è —Ä–æ—É—Ç–µ—Ä–æ–≤ Keenetic (–Ω–∞–ø—Ä–∏–º–µ—Ä **Giga KN‚Äë1012**) –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è **–Ω–∞ —Å–∞–º–æ–º —Ä–æ—É—Ç–µ—Ä–µ** –≤ Entware (`/opt`)
–∏ –¥–∞—ë—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏ –≤ Telegram + —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- üß† **Router**: —Å—Ç–∞—Ç—É—Å, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç‚Äë—Ç–µ—Å—Ç, DHCP (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω `ndmc`), ip/route/iptables, reboot (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)
- üß¨ **HydraRoute Neo/Classic**: start/stop/restart/status, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `domain.conf`, –ø–æ–∏—Å–∫/–¥—É–±–ª–∏–∫–∞—Ç—ã, –∏–º–ø–æ—Ä—Ç `domain.conf`
- üß∑ **NFQWS2 (+web)**: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º, —Å–ø–∏—Å–∫–∏ (`user/exclude/auto`), –∏–º–ø–æ—Ä—Ç `user.list`, –ª–æ–≥–∏, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ NFQUEUE
- üßø **AWG Manager**: —Å–ø–∏—Å–æ–∫ —Ç—É–Ω–Ω–µ–ª–µ–π, –¥–µ–π—Å—Ç–≤–∏—è (start/stop/restart/toggle), system/wan, logs, diagnostics, update check/apply
- üì¶ **opkg**: update / list‚Äëupgradable / upgrade —Ü–µ–ª–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- üîî **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –∏–Ω—Ç–µ—Ä–Ω–µ—Ç down/up, –ø–∞–¥–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤, –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Å –∫–Ω–æ–ø–∫–∞–º–∏ ‚Äú–ú–µ–Ω—é/Restart/–õ–æ–≥–∏‚Äù)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Entware —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, `/opt` —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- –î–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å —Ä–æ—É—Ç–µ—Ä–∞ (–Ω—É–∂–Ω–æ –¥–ª—è Telegram API –∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤)
- Python3 –≤ Entware (—Å–∫—Ä–∏–ø—Ç –ø–æ—Å—Ç–∞–≤–∏—Ç —Å–∞–º)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (one‚Äëliner –∏–∑ GitHub)

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ (—Å–∫—Ä–∏–ø—Ç —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–æ–¥—É–ª–∏ –∏ —Å–ø—Ä–æ—Å–∏—Ç):
```sh
opkg update && opkg install ca-certificates curl && \
curl -Ls https://raw.githubusercontent.com/Stak646/keenetic-TG-Bot/main/autoinstall.sh | sh
```

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–ø–æ—Å—Ç–∞–≤–∏—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–µ –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤):

–ï—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—à—å –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–≤–æ–¥–∞ (—Å–∫—Ä–∏–ø—Ç–æ–º), –ø–µ—Ä–µ–¥–∞–π –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫:
```sh
curl -Ls https://raw.githubusercontent.com/Stak646/keenetic-TG-Bot/main/autoinstall.sh | sh -s -- --bot --yes --token <BOT_TOKEN> --admin <USER_ID>
```
```sh
opkg update && opkg install ca-certificates curl && \
curl -Ls https://raw.githubusercontent.com/Stak646/keenetic-TG-Bot/main/autoinstall.sh | sh -s -- --yes
```

> –°–∫—Ä–∏–ø—Ç —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ `curl | sh`: –æ–Ω —Å–∞–º **—Å–∫–∞—á–∏–≤–∞–µ—Ç —Å–≤–µ–∂–∏–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞** –∏–∑ GitHub –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –±–æ—Ç–∞.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞
–í–æ –≤—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `autoinstall.sh` –ø–æ–ø—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏:
- `bot_token` (—Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞)
- `admin user_id` (—Ç–≤–æ–π Telegram ID —á–∏—Å–ª–æ–º)

### –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å bot_token
1) –û—Ç–∫—Ä–æ–π Telegram –∏ –Ω–∞–π–¥–∏ **@BotFather**
2) –í—ã–ø–æ–ª–Ω–∏ –∫–æ–º–∞–Ω–¥—É `/newbot`
3) –ü—Ä–∏–¥—É–º–∞–π –∏–º—è –∏ username –±–æ—Ç–∞
4) BotFather –≤—ã–¥–∞—Å—Ç —Ç–æ–∫–µ–Ω –≤–∏–¥–∞ `123456:ABC-DEF...` ‚Äî —ç—Ç–æ –∏ –µ—Å—Ç—å `bot_token`

### –ö–∞–∫ —É–∑–Ω–∞—Ç—å —Å–≤–æ–π user_id
–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±:
- –ù–∞–ø–∏—à–∏ –±–æ—Ç—É **@userinfobot** (–∏–ª–∏ –ª—é–±–æ–º—É –±–æ—Ç—É, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ID) ‚Äî –æ–Ω –æ—Ç–≤–µ—Ç–∏—Ç —á–∏—Å–ª–æ–º `Id: ...`

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–Ω—Ñ–∏–≥ –±—É–¥–µ—Ç –∑–¥–µ—Å—å:
`/opt/etc/keenetic-tg-bot/config.json`

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º:
```sh
/opt/etc/init.d/S99keenetic-tg-bot status
/opt/etc/init.d/S99keenetic-tg-bot restart
tail -n 200 /opt/var/log/keenetic-tg-bot.log
```

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –æ–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞ –∏ —Å–∫—Ä–∏–ø—Ç—ã:
```sh
curl -Ls https://raw.githubusercontent.com/Stak646/keenetic-TG-Bot/main/autoinstall.sh | sh -s -- --bot --yes
```

## –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ —á–µ—Ç–≤–µ—Ä–≥–∞–º 06:00
–û–ø—Ü–∏—è `--weekly` —Å—Ç–∞–≤–∏—Ç cron‚Äë–∑–∞–¥–∞—á—É –∏ —Å–æ–∑–¥–∞—ë—Ç:
- `/opt/bin/weekly-update.sh`
- `/opt/var/log/weekly-update.log`

`weekly-update.sh` –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–∞–∫–µ—Ç—ã —á–µ—Ä–µ–∑ `opkg` –∏ **–æ–±–Ω–æ–≤–ª—è–µ—Ç —Ñ–∞–π–ª—ã –±–æ—Ç–∞ –∏–∑ GitHub**, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã.


## –í–∞–∂–Ω–æ –ø—Ä–æ –≤–≤–æ–¥ (curl | sh)
–ï—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ—à—å —É—Å—Ç–∞–Ω–æ–≤–∫—É —Ç–∞–∫: `curl ... | sh`, —Ç–æ –æ–±—ã—á–Ω—ã–π `read` —á–∏—Ç–∞–µ—Ç –∏–∑ pipe.
–°–∫—Ä–∏–ø—Ç —É–∂–µ —á–∏—Ç–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –∏–∑ `/dev/tty`, –ø–æ—ç—Ç–æ–º—É –≤–æ–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç.

–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π —É–≥–ª–æ–≤—ã–µ —Å–∫–æ–±–∫–∏ `< >` –≤ –∫–æ–º–∞–Ω–¥–∞—Ö. –ü–∏—à–∏ —Ç–∞–∫:
```sh
curl -Ls https://raw.githubusercontent.com/Stak646/keenetic-TG-Bot/main/autoinstall.sh | \
sh -s -- --bot --yes --token 123456:ABCDEF --admin 599497434
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ë–æ—Ç **–Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã** –∏–∑ —á–∞—Ç–∞.
- –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Å–ø–∏—Å–∫–æ–º `admins`.
- –ù–µ –ø—É–±–ª–∏–∫—É–π —Ç–æ–∫–µ–Ω –∏ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–π –Ω–∞—Ä—É–∂—É –ª–æ–∫–∞–ª—å–Ω—ã–µ API (–Ω–∞–ø—Ä–∏–º–µ—Ä AWG Manager).

## –°–¥–µ–ª–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é –ò–ò
–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –∏ –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è —Å –ø–æ–º–æ—â—å—é **–ò–ò‚Äë–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (ChatGPT)** –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º –∞–≤—Ç–æ—Ä–∞.
–ê–≤—Ç–æ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–≤–æ—ë–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏.


## –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç y/N –∏ –ø–æ—Ç–æ–º –Ω–∏—á–µ–≥–æ –Ω–µ —Å—Ç–∞–≤–∏—Ç
–†–∞–Ω—å—à–µ –≤ ash –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ `( ... )`, —Ç–µ—Ä—è–ª–∏—Å—å (—ç—Ç–æ subshell). –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ.
