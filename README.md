# Keenetic TG Bot ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–º, HydraRoute, NFQWS2, AWG (Entware)

Telegram‚Äë–±–æ—Ç –¥–ª—è Keenetic (–Ω–∞–ø—Ä–∏–º–µ—Ä **Giga KN‚Äë1012**) –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è **–ø—Ä—è–º–æ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ** –≤ Entware (`/opt`)
–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å:

- üß† —Ä–æ—É—Ç–µ—Ä–æ–º (—Å—Ç–∞—Ç—É—Å, —Å–µ—Ç—å, DHCP, reboot, –±–∞–∑–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)
- üß¨ **HydraRoute Neo/Classic** (start/stop/restart/status, —Ä–∞–±–æ—Ç–∞ —Å `domain.conf`, —Å—Å—ã–ª–∫–∞ –Ω–∞ HRweb –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
- üß∑ **NFQWS2** (+ **NFQWS web**, –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω) ‚Äî —Å–µ—Ä–≤–∏—Å, —Å–ø–∏—Å–∫–∏, –ª–æ–≥–∏, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ NFQUEUE
- üßø **AWG Manager** ‚Äî —Å–µ—Ä–≤–∏—Å, web‚Äë–ø–∞–Ω–µ–ª—å, health‚Äëcheck, `wg show`
- üì¶ **opkg** ‚Äî update / list‚Äëupgradable / upgrade —Ü–µ–ª–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- üîî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: –ø–∞–¥–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤, –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç down/up, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è opkg

## –í–∞–∂–Ω–æ
- –ë–æ—Ç **–Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã** –∏–∑ —á–∞—Ç–∞ ‚Äî —Ç–æ–ª—å–∫–æ –∑–∞—Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.
- –î–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø–æ Telegram **user_id** (—Å–º. `admins`).
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö –¥–µ–ª–∞—é—Ç—Å—è —Å –±—ç–∫–∞–ø–æ–º —Ñ–∞–π–ª–æ–≤.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (—Ä—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞)
1) –£–±–µ–¥–∏—Å—å, —á—Ç–æ Entware —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ `/opt` —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω.
2) –°–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Ä–æ—É—Ç–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä –≤ `/opt/tmp/keenetic-tg-bot`).
3) –ó–∞–ø—É—Å—Ç–∏:
```sh
sh install.sh
```
4) –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π –∫–æ–Ω—Ñ–∏–≥:
`/opt/etc/keenetic-tg-bot/config.json`
–∏ —É–∫–∞–∂–∏ `bot_token` –∏ `admins` (—Ç–≤–æ–π Telegram user_id).

5) –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º:
```sh
/opt/etc/init.d/S99keenetic-tg-bot status
/opt/etc/init.d/S99keenetic-tg-bot restart
tail -n 200 /opt/var/log/keenetic-tg-bot.log
```

## –ê–≤—Ç–æ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–°–∫—Ä–∏–ø—Ç **—Å–∞–º –ø—Ä–æ–≤–µ—Ä—è–µ—Ç**, –∫–∞–∫–∏–µ –º–æ–¥—É–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã, –∏ **–ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ**.

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ (–ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏)
```sh
sh autoinstall.sh
```

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–µ –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤
```sh
sh autoinstall.sh --yes
```

### –í—ã–±–æ—Ä–æ—á–Ω–æ
```sh
sh autoinstall.sh --bot --cron --weekly
sh autoinstall.sh --hydra --nfqws2 --nfqwsweb --awg
```

## –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
–û–ø—Ü–∏—è `--weekly` —Å—Ç–∞–≤–∏—Ç cron‚Äë–∑–∞–¥–∞—á—É –Ω–∞ **–∫–∞–∂–¥—ã–π —á–µ—Ç–≤–µ—Ä–≥ 06:00** –∏ —Å–æ–∑–¥–∞—ë—Ç:
- `/opt/bin/weekly-update.sh`
- –ª–æ–≥ `/opt/var/log/weekly-update.log`

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
–í `config.json`:
- `monitor.enabled`
- `notify.*`
- –ø–æ—Ä–æ–≥–∏ –Ω–∞–≥—Ä—É–∑–∫–∏/–º–µ—Å—Ç–∞ –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ù–µ –¥–æ–±–∞–≤–ª—è–π –ª–∏—à–Ω–∏—Ö –ª—é–¥–µ–π –≤ `admins`.
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–æ—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã **—Ç–æ–ª—å–∫–æ –≤ –ª–∏—á–∫–µ –∞–¥–º–∏–Ω–æ–≤** (–µ—Å–ª–∏ `allow_chats` –ø—É—Å—Ç–æ–π).

## –°–¥–µ–ª–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é –ò–ò
–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –∏ –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è —Å –ø–æ–º–æ—â—å—é **–ò–ò‚Äë–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (ChatGPT)** –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º –∞–≤—Ç–æ—Ä–∞. –ê–≤—Ç–æ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É,
—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–≤–æ—ë–º —Ä–æ—É—Ç–µ—Ä–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ.

## –õ–∏—Ü–µ–Ω–∑–∏—è
–î–æ–±–∞–≤—å –ª–∏—Ü–µ–Ω–∑–∏—é –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã (MIT/Apache‚Äë2.0 –∏ —Ç.–¥.).



## One-liner —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å GitHub

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ (—Å–∫—Ä–∏–ø—Ç —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–æ–¥—É–ª–∏ –∏ —Å–ø—Ä–æ—Å–∏—Ç):
```sh
opkg update && opkg install ca-certificates curl && \
curl -Ls https://raw.githubusercontent.com/Stak646/keenetic-TG-Bot/main/autoinstall.sh | sh
```

–ë–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤ (–ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å—ë –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):
```sh
opkg update && opkg install ca-certificates curl && \
curl -Ls https://raw.githubusercontent.com/Stak646/keenetic-TG-Bot/main/autoinstall.sh | sh -s -- --yes
```


## –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å—Ç–∞–ª–∏ ‚Äú–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º–∏‚Äù: –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∏ **–ú–µ–Ω—é / Restart / –õ–æ–≥–∏**.
- HydraRoute Neo:
  - üìö —Å–≤–æ–¥–∫–∞ –ø—Ä–∞–≤–∏–ª `domain.conf` (–∫–æ–ª-–≤–æ –¥–æ–º–µ–Ω–æ–≤ –ø–æ —Ü–µ–ª—è–º)
  - üîé –ø–æ–∏—Å–∫ –¥–æ–º–µ–Ω–∞ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ
  - üß© –ø–æ–∏—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –¥–æ–º–µ–Ω–æ–≤ –º–µ–∂–¥—É —Ü–µ–ª—è–º–∏
  - ‚¨ÜÔ∏è –∏–º–ø–æ—Ä—Ç –Ω–æ–≤–æ–≥–æ `domain.conf` —Ñ–∞–π–ª–æ–º —á–µ—Ä–µ–∑ Telegram (—Å –±—ç–∫–∞–ø–æ–º –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º Neo)
- NFQWS2:
  - üìÑ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ `user.list / exclude.list / auto.list`
  - ‚¨ÜÔ∏è –∏–º–ø–æ—Ä—Ç –Ω–æ–≤–æ–≥–æ `user.list` —Ñ–∞–π–ª–æ–º (—Å –±—ç–∫–∞–ø–æ–º –∏ `reload`)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –ø—Ä–∏—Ö–æ–¥—è—Ç —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º –∏ –ø–æ–¥—Å–∫–∞–∑–∫–æ–π ‚Äú—á—Ç–æ —Å–¥–µ–ª–∞—Ç—å‚Äù.


## AWG Manager API (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
–ï—Å–ª–∏ AWG Manager –æ—Ç–¥–∞—ë—Ç Swagger/OpenAPI (—É —Ç–µ–±—è —Ç–∞–∫ –∏ –µ—Å—Ç—å), –±–æ—Ç —É–º–µ–µ—Ç:
- –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—É–Ω–Ω–µ–ª–µ–π
- –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ —Ç—É–Ω–Ω–µ–ª—è
- start/stop/restart, toggle enabled, toggle default route
- –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å status/all, logs, update/check

–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ:
```sh
PORT=2222
curl -s http://127.0.0.1:${PORT}/api/health ; echo
curl -s http://127.0.0.1:${PORT}/swagger/v1/swagger.json | head -n 5
```

–ï—Å–ª–∏ `openapi.json` –æ—Ç–¥–∞—ë—Ç HTML, –∏—Å–ø–æ–ª—å–∑—É–π `swagger/v1/swagger.json` ‚Äî —ç—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π JSON —Å–æ —Å—Ö–µ–º–æ–π.



## –ó–∞–≥—Ä—É–∑–∫–∞ –≤ GitHub (Windows 11, PowerShell)

### –ü–µ—Ä–≤—ã–π –∑–∞–ª–∏–≤ –≤ –ø—É—Å—Ç–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
1) –†–∞—Å–ø–∞–∫—É–π –ø—Ä–æ–µ–∫—Ç –≤ –ø–∞–ø–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä: `C:\work\keenetic-TG-Bot-src`
2) –í—ã–ø–æ–ª–Ω–∏:

```powershell
cd C:\work
git clone https://github.com/Stak646/keenetic-TG-Bot.git
cd keenetic-TG-Bot

robocopy C:\work\keenetic-TG-Bot-src . /E

git add .
git commit -m "Initial import"
git branch -M main
git push -u origin main
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫)
```powershell
cd C:\work\keenetic-TG-Bot
git pull
# –≤–Ω–µ—Å–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è/–∑–∞–º–µ–Ω–∏ —Ñ–∞–π–ª—ã
git add .
git commit -m "Update"
git push
```

